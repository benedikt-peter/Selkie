image: docker:latest
services:
  - docker:dind

stages:
  - build

build:
  stage: build
  script:
    - docker build --pull -t selkie-build-image utils/ci
    - docker run --rm -v ./:/workspace:rw selkie-build-image /bin/bash -c "mkdir /workspace/build && cd /workspace/build && cmake ../ && cmake --build"